<div class="card container">
  <h1 class="h2 mb-0">Events</h1>
</div>

<!-- Recurring -->
<div class="card container mt-2">
  <h2 class="h3 mb">Recurring events</h2>
  <div class="container-inner">
    <div class="grid grid-4">
      <div class="card p-rel" *ngFor="let event of recurring; let i = index;">
        <ng-container *ngTemplateOutlet="eventDiv; context: {$implicit: event}"></ng-container>
      </div>
    </div>
  </div>
</div>

<!-- Past -->
<div class="card container mt-2">
  <h2 class="h3">Past events</h2>
  <div class="container-inner">
    <div class="grid grid-3">
      <div class="card p-rel" *ngFor="let event of old; let i = index;">
        <ng-container *ngTemplateOutlet="eventDiv; context: {$implicit: event}"></ng-container>
      </div>
    </div>
  </div>
</div>



<ng-template #eventDiv let-event>
  <h2 class="h3">{{ event.name }}</h2>
  <!-- Wiki -->
  <div class="wiki p-abs" *ngIf="event._wiki?.href">
    <a [href]="event._wiki!.href" target="_blank" [ngbTooltip]="'Open wiki'" placement="left" container="body">
      <mat-icon fontIcon="question_mark"></mat-icon>
    </a>
  </div>
  <!-- Image -->
  <div *ngIf="event.imageUrl" class="p-rel img"
    [style.background-image]="'url('+event.imageUrl+')'"
    [style.background-position]="event.imagePosition || undefined"></div>
  <!-- Overview -->
  <a class="mt-2 item" [routerLink]="['/event', event.guid]">
    <mat-icon class="menu-icon" fontIcon="article"></mat-icon>
    <span class="menu-label">
      Overview
    </span>
  </a>
  <!-- Jump to last -->
  <a class="mt-2 item" *ngIf="lastInstances[event.guid]" [routerLink]="['/event-instance', $any(lastInstances[event.guid]).guid]">
    <mat-icon class="menu-icon" fontIcon="schedule"></mat-icon>
    <span class="menu-label">
      Most recent
      <span class="c-accent">({{ $any(lastInstances[event.guid]).date | date:'yyyy' }})</span>
    </span>
  </a>
</ng-template>
